<!DOCTYPE html>
<html lang="en">
<style>
  .product {
    margin: 10px;
    padding: 10px;
    border: 1px solid #ccc;
  }
  .cart {
    margin-top: 20px;
    padding: 10px;
    border: 1px solid #ccc;
  }
  .cart-item {
    margin: 5px 0;
  }
  button {
    margin: 5px;
  }
</style>
<body>
<h1>Shopping Cart Example</h1>
<div id="root"></div>

<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<script type="text/babel">
  function useCart() {
    const [cartItems, setCartItems] = React.useState([]);

    const handleAddToCart = (product) => {
      setCartItems((currentItems) => {
        const existingItem = currentItems.find(
                (item) => item.id === product.id,
        );
        if (existingItem) {
          return currentItems.map((item) =>
                  item.id === product.id
                          ? { ...item, quantity: item.quantity + 1 }
                          : item,
          );
        } else {
          return [...currentItems, { ...product, quantity: 1 }];
        }
      });
    };

    const handleUpdateQuantity = (id, type) => {
      setCartItems((currentItems) => {
        return currentItems
                .map((item) => {
                  if (item.id !== id) return item;
                  const newQty =
                          type === "inc" ? item.quantity + 1 : item.quantity - 1;
                  return newQty > 0 ? { ...item, quantity: newQty } : null;
                })
                .filter((item) => item !== null);
      });
    };

    return { cartItems, handleAddToCart, handleUpdateQuantity };
  }

  function Product({ product, onAddToCart }) {
    return (
            <div className="product">
              <h3>{product.name}</h3>
              <p>${product.price}</p>
              <button onClick={() => onAddToCart(product)}>Add to Cart</button>
            </div>
    );
  }

  function ProductList({ products, onAddToCart }) {
    return (
            <div>
              <h2>Products</h2>
              <div>
                {products.map((product) => (
                        <Product
                                key={product.id}
                                product={product}
                                onAddToCart={onAddToCart}
                        />
                ))}
              </div>
            </div>
    );
  }

  function CartItem({ item, onUpdateQuantity }) {
    return (
            <div className="cart-item">
            <span>
              {item.name} - ${item.price} x {item.quantity} = $
              {item.price * item.quantity}
            </span>
              <button onClick={() => onUpdateQuantity(item.id, "inc")}>+</button>
              <button onClick={() => onUpdateQuantity(item.id, "dec")}>-</button>
            </div>
    );
  }

  function Cart({ items, onUpdateQuantity }) {
    const total = items.reduce(
            (sum, item) => sum + item.price * item.quantity,
            0,
    );

    return (
            <div className="cart">
              <h2>Shopping Cart</h2>
              {items.length === 0 ? (
                      <p>Your cart is empty</p>
              ) : (
                      <div>
                        {items.map((item) => (
                                <CartItem
                                        key={item.id}
                                        item={item}
                                        onUpdateQuantity={onUpdateQuantity}
                                />
                        ))}
                        <h3>Total: ${total}</h3>
                      </div>
              )}
            </div>
    );
  }

  function App() {
    const { cartItems, handleAddToCart, handleUpdateQuantity } = useCart();

    const products = [
      { id: 1, name: "Product 1", price: 10 },
      { id: 2, name: "Product 2", price: 15 },
      { id: 3, name: "Product 3", price: 20 },
    ];

    return (
            <>
              <ProductList products={products} onAddToCart={handleAddToCart} />
              <Cart items={cartItems} onUpdateQuantity={handleUpdateQuantity} />
            </>
    );
  }

  const root = ReactDOM.createRoot(document.getElementById("root"));
  root.render(<App />);
</script>
</body>
</html>
